<div class="file-select">
    <div class="file-preview" (click)="onPreviewClicked()" *ngIf="inputShowPreview">
        <span *ngIf="isWebImage(value)" [style.background-image]="'url(' + value + ')'"></span>
        <span *ngIf="!isWebImage(value)">
            <span [class]="getIconClass(value)">
                <span class="path1"></span>
                <span class="path2"></span>
                <span class="path3"></span>
                <span class="path4"></span>
                <span class="path5"></span>
                <span class="path6"></span>
            </span>
        </span>
    </div>
    <mat-form-field class="w-100" [placement]="inputTooltipPlacement" [tcTooltip]="inputTooltipText">
        <input
            #valueInput
            matInput
            [id]="_id"
            type="text"
            [(ngModel)]="value"
            [name]="inputName"
            (blur)="onBlur()"
            autocomplete="off"
            [disabled]="isDisabled"
            [pattern]="regex"
            readonly
            [placeholder]="inputName"
            [required]="inputIsRequired"
            (click)="valueInput.select()"
        />
        <button
            matSuffix
            mat-icon-button
            [disabled]="inputIsDisabled"
            [tcTooltip]="_translationPrefix + '.chooseFile' | translate: _locale.language"
            placement="left"
            (click)="openFileBrowserDialog()"
        >
            <mat-icon>more_horiz</mat-icon>
        </button>
        <button
            matSuffix
            mat-icon-button
            [tcTooltip]="_translationPrefix + '.reset' | translate: _locale.language"
            [placement]="'left'"
            (click)="resetValue()"
        >
            <mat-icon>clear</mat-icon>
        </button>
    </mat-form-field>

    <ng-template let-data #imagePreviewDialog>
        <h2 mat-dialog-title>{{ data.filename }}</h2>
        <mat-dialog-content>
            <img [src]="data.filepath" />
        </mat-dialog-content>
    </ng-template>

    <ng-template #fileBrowserDialog>
        <mat-dialog-content>
            <terra-file-browser
                #fileBrowser
                [inputAllowedExtensions]="inputAllowedExtensions"
                [inputAllowFolders]="inputAllowFolders"
                [inputStorageServices]="inputStorageServices"
                (outputSelectedChange)="onSelectedObjectChange($event)"
            >
            </terra-file-browser>
        </mat-dialog-content>
        <mat-dialog-actions>
            <button mat-flat-button mat-dialog-close>
                {{ _translationPrefix + '. cancel' | translate: _locale.language }}
            </button>
            <button
                mat-flat-button
                class="terra-color-active"
                [disabled]="_selectedObject ? _selectedObject.isDirectory : true"
                [mat-dialog-close]="_selectedObject"
            >
                {{ inputPrimaryBrowserButtonCaption }}
            </button>
        </mat-dialog-actions>
    </ng-template>
</div>
